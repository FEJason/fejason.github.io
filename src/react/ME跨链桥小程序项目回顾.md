# ME è·¨é“¾æ¡¥å°ç¨‹åºé¡¹ç›®å›é¡¾

å°ç¨‹åºå¼€å‘ä¸­é‡åˆ°çš„é—®é¢˜å›é¡¾ï¼š

## React ä¿®æ”¹çŠ¶æ€åç«‹å³è°ƒç”¨æ¥å£ï¼Œä½†å‘ç°æ¥å£ä½¿ç”¨çš„çŠ¶æ€å­—æ®µâ€œæ²¡æœ‰å®æ—¶æ›´æ–°

åœ¨ React ä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„é—®é¢˜ã€‚å…¶æ ¹æœ¬åŸå› åœ¨äº **React çš„çŠ¶æ€æ›´æ–°æ˜¯å¼‚æ­¥çš„ï¼ˆasynchronousï¼‰å’Œæ‰¹é‡çš„ï¼ˆbatchedï¼‰**ã€‚

---

### é—®é¢˜ç°è±¡ç¤ºä¾‹

```jsx
const [value, setValue] = useState('')

const handleClick = () => {
  setValue('new value')
  console.log(value) // ä»ç„¶æ˜¯æ—§å€¼ï¼
  fetchData(value) // æ¥å£ä¼ å…¥çš„è¿˜æ˜¯æ—§å€¼ï¼
}
```

ä½ æœŸæœ› `fetchData` ä½¿ç”¨ `'new value'`ï¼Œä½†å®é™…ä¸Šå®ƒç”¨äº†æ›´æ–°å‰çš„ `value`ã€‚

---

### åŸå› åˆ†æ

- `setValue()` **ä¸ä¼šç«‹å³æ”¹å˜ `value` å˜é‡**ã€‚
- React ä¼šå°†çŠ¶æ€æ›´æ–°æ”¾å…¥é˜Ÿåˆ—ï¼Œåœ¨**ä¸‹ä¸€æ¬¡æ¸²æŸ“æ—¶æ‰åº”ç”¨æ–°å€¼**ã€‚
- å½“å‰å‡½æ•°ä½œç”¨åŸŸä¸­çš„ `value` ä»ç„¶æ˜¯**é—­åŒ…æ•è·çš„æ—§å€¼**ã€‚

---

### æ­£ç¡®è§£å†³æ–¹æ¡ˆ

#### æ–¹æ¡ˆ 1ï¼šåœ¨ `useEffect` ä¸­å“åº”çŠ¶æ€å˜åŒ–å¹¶è°ƒç”¨æ¥å£ï¼ˆæ¨èï¼‰

é€‚ç”¨äºï¼šçŠ¶æ€æ›´æ–°å**è‡ªåŠ¨è§¦å‘**æ¥å£è¯·æ±‚ã€‚

```jsx
const [value, setValue] = useState('')

useEffect(() => {
  if (value) {
    fetchData(value) // value æ˜¯æœ€æ–°å€¼
  }
}, [value]) // ä¾èµ–é¡¹

const handleClick = () => {
  setValue('new value') // è§¦å‘ useEffect
}
```

> ä¼˜ç‚¹ï¼šç¬¦åˆ React å“åº”å¼èŒƒå¼ï¼Œé€»è¾‘æ¸…æ™°  
> æ³¨æ„ï¼šé¿å…æ— é™å¾ªç¯ï¼ˆç¡®ä¿ `fetchData` ä¸ä¼šå†æ¬¡ä¿®æ”¹ `value`ï¼‰

---

#### æ–¹æ¡ˆ 2ï¼šç›´æ¥ä½¿ç”¨æ–°å€¼è°ƒç”¨æ¥å£ï¼ˆä¸ä¾èµ–çŠ¶æ€å˜é‡ï¼‰

é€‚ç”¨äºï¼šä½ çŸ¥é“è¦è®¾ç½®çš„å€¼ï¼Œä¸”æ¥å£åªéœ€è¿™ä¸ªæ–°å€¼ã€‚

```jsx
const handleClick = () => {
  const newValue = 'new value'
  setValue(newValue)
  fetchData(newValue) // ç›´æ¥ç”¨ newValueï¼Œä¸ä¾èµ– state
}
```

> ç®€å•é«˜æ•ˆï¼Œé¿å…å¼‚æ­¥é—®é¢˜  
> ä¸é€‚ç”¨ï¼šå¦‚æœæ–°å€¼ä¾èµ–å¤æ‚è®¡ç®—æˆ–å¤šä¸ªçŠ¶æ€ç»„åˆæˆ–å‡½æ•°åµŒå¥—è°ƒç”¨

---

#### æ–¹æ¡ˆ 3ï¼šä½¿ç”¨ `useRef` åŒæ­¥æœ€æ–°å€¼ï¼ˆé«˜çº§åœºæ™¯ï¼‰

å¦‚æœä½ å¿…é¡»åœ¨åŒä¸€ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°ä¸­â€œè·å–åˆšè®¾ç½®çš„çŠ¶æ€â€ï¼Œå¯ç”¨ `ref` ä½œä¸ºæ¡¥æ¢ï¼š

```jsx
const valueRef = useRef('')
const [value, setValue] = useState('')

const handleClick = () => {
  const newValue = 'new value'
  setValue(newValue)
  valueRef.current = newValue
  fetchData(valueRef.current)
}
```

> ä¸€èˆ¬ä¸æ¨èï¼Œé™¤éä¸ç¬¬ä¸‰æ–¹åº“é›†æˆç­‰ç‰¹æ®Šåœºæ™¯

---

### é”™è¯¯åšæ³•ï¼ˆå¸¸è§è¯¯åŒºï¼‰

```jsx
// âŒ é”™è¯¯ï¼šä»¥ä¸º setValue å value ç«‹åˆ»å˜äº†
setValue('new')
fetchData(value) // è¿˜æ˜¯æ—§å€¼ï¼

// âŒ é”™è¯¯ï¼šç”¨ setTimeout â€œç­‰ä¸€ä¸‹â€
setTimeout(() => fetchData(value), 0) // ä»å¯èƒ½æ‹¿åˆ°æ—§å€¼ï¼ˆå–å†³äºæ¸²æŸ“æ—¶æœºï¼‰
```

---

### æ€»ç»“ï¼šå¦‚ä½•é€‰æ‹©ï¼Ÿ

| åœºæ™¯                     | æ¨èæ–¹æ¡ˆ                                        |
| ------------------------ | ----------------------------------------------- |
| çŠ¶æ€å˜ â†’ è‡ªåŠ¨è¯·æ±‚æ•°æ®    | **`useEffect` + ä¾èµ–é¡¹**                        |
| ä½ çŸ¥é“æ–°å€¼ï¼Œä¸”åªéœ€ä¼ å®ƒ   | **ç›´æ¥ç”¨æ–°å€¼è°ƒç”¨æ¥å£**                          |
| å¤æ‚è¡¨å•æäº¤ï¼ˆå¤šä¸ªå­—æ®µï¼‰ | **åœ¨æäº¤å‡½æ•°ä¸­æ”¶é›†æ‰€æœ‰æ–°å€¼ï¼Œä¸ä¾èµ– state å˜é‡** |

---

### ç¤ºä¾‹ï¼šè¡¨å•æäº¤åœºæ™¯

```jsx
const [formData, setFormData] = useState({ name: '', email: '' })

const handleSubmit = () => {
  // æ­£ç¡®ï¼šåŸºäºå½“å‰è¾“å…¥æ„å»ºæ–°æ•°æ®
  const newFormData = { name: 'Alice', email: 'alice@example.com' }
  setFormData(newFormData)
  submitToAPI(newFormData) // ç”¨ newFormDataï¼Œä¸æ˜¯ formDataï¼
}
```

---

## React æ²¡æœ‰åƒ Vue é‚£æ ·â€œå¼€ç®±å³ç”¨â€çš„åŒå‘ç»‘å®šï¼ˆæ¯”å¦‚ `v-model`ï¼‰

è¿™ä¸æ˜¯ React â€œä¸å¥½ç”¨â€ï¼Œè€Œæ˜¯å®ƒé€‰æ‹©äº†**æ›´æ˜ç¡®ã€æ›´å¯æ§çš„æ•°æ®æµæ–¹å¼**ã€‚

---

### ä¸¾ä¸ªä¾‹å­ï¼šè¾“å…¥æ¡†åŒæ­¥

#### åœ¨ Vue ä¸­ï¼ˆéå¸¸ç®€æ´ï¼‰ï¼š

```vue
<template>
  <input v-model="message" />
  <p>ä½ è¾“å…¥äº†ï¼š{{ message }}</p>
</template>

<script>
export default {
  data() {
    return { message: '' }
  }
}
</script>
```

â†’ ç”¨æˆ·ä¸€æ‰“å­—ï¼Œ`message` è‡ªåŠ¨æ›´æ–°ï¼Œé¡µé¢ä¹Ÿè‡ªåŠ¨åˆ·æ–°ã€‚**åŒå‘ç»‘å®šå®Œæˆã€‚**

---

#### åœ¨ React ä¸­ï¼ˆçœ‹èµ·æ¥â€œå•°å—¦â€ï¼‰ï¼š

```jsx
import React, { useState } from 'react'

function App() {
  const [message, setMessage] = useState('')

  return (
    <>
      <input value={message} onChange={e => setMessage(e.target.value)} />
      <p>ä½ è¾“å…¥äº†ï¼š{message}</p>
    </>
  )
}
```

çœ‹èµ·æ¥è¦å†™ `value` + `onChange`ï¼Œä¸å¦‚ Vue ä¸€è¡Œ `v-model` ç®€æ´ã€‚

**ä½†è¿™å°±æ˜¯ React çš„è®¾è®¡åŸåˆ™ï¼šæ˜¾å¼æ§åˆ¶ï¼Œæ²¡æœ‰éšè—é€»è¾‘ã€‚**

---

### ä¸ºä»€ä¹ˆ React ä¸åšâ€œè‡ªåŠ¨åŒå‘ç»‘å®šâ€ï¼Ÿ

å› ä¸º React è®¤ä¸ºï¼š

> **â€œçŠ¶æ€æ˜¯å”¯ä¸€çš„çœŸç›¸æ¥æºï¼ŒUI æ˜¯çŠ¶æ€çš„å‡½æ•°ã€‚â€**

- å¦‚æœå…è®¸ DOM ç›´æ¥ä¿®æ”¹çŠ¶æ€ï¼ˆåƒ Vue é‚£æ ·ï¼‰ï¼Œå°±å®¹æ˜“é€ æˆ**æ•°æ®æµå‘æ··ä¹±**ã€‚
- React å¼ºåˆ¶ä½ å†™æ¸…æ¥šï¼š**è°è§¦å‘äº†çŠ¶æ€å˜åŒ–ï¼Ÿæ€ä¹ˆå˜çš„ï¼Ÿ**
- è¿™åœ¨å¤§å‹é¡¹ç›®ä¸­æ›´å®¹æ˜“è°ƒè¯•å’Œç»´æŠ¤ã€‚

---

### é‚£èƒ½ä¸èƒ½è®© React ä¹Ÿâ€œå¥½ç”¨â€ä¸€ç‚¹ï¼Ÿ

**å¯ä»¥ï¼æˆ‘ä»¬è‡ªå·±å°è£…ä¸€ä¸ªç®€å•çš„â€œåŒå‘ç»‘å®šâ€å·¥å…·ã€‚**

#### æ–¹æ³•ï¼šå†™ä¸€ä¸ªè‡ªå®šä¹‰ Hook

```jsx
// hooks/useModel.js
import { useState, useCallback } from 'react'

export function useModel(initialValue) {
  const [value, setValue] = useState(initialValue)

  const bind = {
    value: value,
    onChange: useCallback(e => {
      setValue(e.target.value)
    }, [])
  }

  return [value, bind]
}
```

#### ä½¿ç”¨å®ƒï¼ˆè¶…ç®€æ´ï¼ï¼‰ï¼š

```jsx
import React from 'react'
import { useModel } from './hooks/useModel'

function App() {
  const [message, messageBind] = useModel('')

  return (
    <>
      <input {...messageBind} />
      <p>ä½ è¾“å…¥äº†ï¼š{message}</p>
    </>
  )
}
```

âœ… æ•ˆæœå‡ ä¹å’Œ Vue çš„ `v-model` ä¸€æ ·ç®€æ´ï¼  
âœ… è€Œä¸”å®Œå…¨ç”±ä½ æ§åˆ¶ï¼Œæ²¡æœ‰é»‘ç›’ã€‚

---

### æ›´è¿›ä¸€æ­¥ï¼šå¤æ‚è¡¨å•æ€ä¹ˆåŠï¼Ÿ

å¦‚æœå­—æ®µå¾ˆå¤šï¼ˆç”¨æˆ·åã€é‚®ç®±ã€å¯†ç â€¦â€¦ï¼‰ï¼Œå¯ä»¥è¿™æ ·ï¼š

```jsx
function UserProfile() {
  const [name, nameBind] = useModel('')
  const [email, emailBind] = useModel('')

  return (
    <form>
      <input placeholder="å§“å" {...nameBind} />
      <input placeholder="é‚®ç®±" {...emailBind} />
      <p>
        ä½ å¥½ï¼Œ{name}ï¼é‚®ç®±æ˜¯ï¼š{email}
      </p>
    </form>
  )
}
```

æˆ–è€…ç›´æ¥ç”¨æˆç†Ÿçš„åº“ï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒä½¿ç”¨ï¼‰ï¼š

- **[React Hook Form](https://react-hook-form.com/)**ï¼ˆè½»é‡ã€é«˜æ€§èƒ½ï¼‰
- å®ƒè®©ä½ å‡ ä¹ä¸ç”¨å†™ `onChange`ï¼Œè¿˜èƒ½è‡ªåŠ¨æ ¡éªŒï¼

```jsx
import { useForm } from 'react-hook-form'

function App() {
  const { register, watch } = useForm()
  const name = watch('name')

  return (
    <>
      <input {...register('name')} /> {/* è‡ªåŠ¨å¤„ç† value + onChange */}
      <p>ä½ è¾“å…¥äº†ï¼š{name}</p>
    </>
  )
}
```

---

### ä½¿ç”¨ antd UI ç»„ä»¶ï¼Œè½»æ¾å®ç°è¡¨å•æäº¤

```jsx
import React from 'react'
import { Form, Input, Button, message } from 'antd'

const LoginForm = () => {
  // åˆ›å»ºè¡¨å•å®ä¾‹
  const [form] = Form.useForm()

  // è¡¨å•æäº¤å¤„ç†å‡½æ•°
  const onFinish = values => {
    console.log('æäº¤çš„æ•°æ®:', values)
    // ä½ å¯ä»¥åœ¨è¿™é‡Œè°ƒç”¨çœŸå®æ¥å£ï¼Œä¾‹å¦‚ï¼š
    // fetch('/api/login', { method: 'POST', body: JSON.stringify(values) })
  }

  // è¡¨å•æ ¡éªŒå¤±è´¥å¤„ç†ï¼ˆå¯é€‰ï¼‰
  const onFinishFailed = errorInfo => {
    console.log('æ ¡éªŒå¤±è´¥:', errorInfo)
  }

  return (
    <div style={{ maxWidth: 400, margin: '50px auto' }}>
      <h2>ç”¨æˆ·ç™»å½•</h2>

      <Form
        form={form}
        name="login-form"
        initialValues={{ remember: true }}
        onFinish={onFinish}
        onFinishFailed={onFinishFailed}
        autoComplete="off"
        layout="vertical"
      >
        <Form.Item
          label="ç”¨æˆ·å"
          name="username"
          rules={[
            { required: true, message: 'è¯·è¾“å…¥ç”¨æˆ·å!' },
            { min: 3, message: 'ç”¨æˆ·åè‡³å°‘3ä¸ªå­—ç¬¦' }
          ]}
        >
          <Input placeholder="è¯·è¾“å…¥ç”¨æˆ·å" />
        </Form.Item>

        <Form.Item
          label="å¯†ç "
          name="password"
          rules={[{ required: true, message: 'è¯·è¾“å…¥å¯†ç !' }]}
        >
          <Input.Password placeholder="è¯·è¾“å…¥å¯†ç " />
        </Form.Item>

        <Form.Item>
          <Button type="primary" htmlType="submit" block>
            ç™»å½•
          </Button>
        </Form.Item>
      </Form>
    </div>
  )
}

export default LoginForm
```

- const [form] = Form.useForm();

  - è¿™æ˜¯ antd æä¾›çš„ Hookï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªå—æ§è¡¨å•å®ä¾‹ã€‚
  - ä½ å¯ä»¥åœ¨ç»„ä»¶å†…é€šè¿‡ form.setFieldsValue()ã€form.getFieldsValue() ç­‰æ–¹æ³•æ“ä½œè¡¨å•ã€‚

- onFinish è‡ªåŠ¨æ¥æ”¶è¡¨å•å€¼

  - å½“ç”¨æˆ·ç‚¹å‡»â€œæäº¤â€ä¸”æ ¡éªŒé€šè¿‡æ—¶ï¼ŒonFinish ä¼šè‡ªåŠ¨è§¦å‘ï¼Œå¹¶ä¼ å…¥ä¸€ä¸ªåŒ…å«æ‰€æœ‰å­—æ®µå€¼çš„å¯¹è±¡ï¼ˆå¦‚ { username: 'alice', password: '123' }ï¼‰ã€‚

- æ ¡éªŒè§„åˆ™å†™åœ¨ rules æ•°ç»„é‡Œ
- required: true è¡¨ç¤ºå¿…å¡«
- æ”¯æŒè‡ªå®šä¹‰æç¤ºæ–‡æ¡ˆ message

- æ— éœ€æ‰‹åŠ¨ç®¡ç†çŠ¶æ€

  - ä¸éœ€è¦å†™ useState æ¥å­˜ç”¨æˆ·å/å¯†ç ï¼Œantd Form å†…éƒ¨å·²ç»å¸®ä½ ç®¡ç†äº†ï¼

- å¦‚æœä½ éœ€è¦åœ¨è¡¨å•å¤–ï¼ˆæ¯”å¦‚ç‚¹å‡»å¦ä¸€ä¸ªæŒ‰é’®ï¼‰è·å–å€¼ï¼š

```jsx
const handleCustomSubmit = () => {
  const values = form.getFieldsValue()
  console.log('å½“å‰è¡¨å•å€¼:', values)
}
```

- æˆ–è€…è®¾ç½®å€¼ï¼š

```jsx
form.setFieldsValue({ username: 'admin' })
```

### æ€»ç»“

| å¯¹æ¯”     | Vue                      | React                       |
| -------- | ------------------------ | --------------------------- |
| åŒå‘ç»‘å®š | å†…ç½® `v-model`ï¼Œä¸€è¡Œæå®š | éœ€æ‰‹åŠ¨å†™ `value + onChange` |
| æ§åˆ¶åŠ›   | éšå¼æ›´æ–°ï¼Œæ–¹ä¾¿ä½†â€œé»‘ç›’â€   | æ˜¾å¼æ›´æ–°ï¼Œé€æ˜å¯æ§          |
| å¯æ‰©å±•æ€§ | ä¾èµ–å“åº”å¼ç³»ç»Ÿ           | å¯è‡ªç”±å°è£…ï¼ˆå¦‚ `useModel`ï¼‰ |
| å¤§å‹é¡¹ç›® | å®¹æ˜“çŠ¶æ€æ··ä¹±             | æ•°æ®æµæ¸…æ™°ï¼Œæ˜“ç»´æŠ¤          |

> **React ä¸æ˜¯æ²¡æœ‰â€œå¥½ç”¨çš„åŒå‘ç»‘å®šâ€ï¼Œè€Œæ˜¯æŠŠâ€œå¥½ä¸å¥½ç”¨â€çš„æƒåŠ›äº¤ç»™äº†ä½ **ã€‚  
> ä½ å¯ä»¥é€‰æ‹©æœ€ç®€å•çš„æ–¹å¼ï¼ˆè‡ªå·±å°è£…ï¼‰ï¼Œä¹Ÿå¯ä»¥ç”¨ä¸“ä¸šå·¥å…·ï¼ˆReact Hook Formï¼‰ï¼Œçµæ´»åˆå¼ºå¤§ã€‚

æ‰€ä»¥ï¼Œä¸æ˜¯ React ä¸å¥½ç”¨ï¼Œåªæ˜¯å®ƒè®©ä½ **å…ˆç†è§£åŸç†ï¼Œå†äº«å—ä¾¿åˆ©**

## React æ²¡æœ‰åƒ Vue é‚£æ ·çš„ è·¯ç”±å®ˆå«ï¼Œè·³è½¬é¡µé¢æ»šåŠ¨æ¡ç½®é¡¶ï¼Œåœ¨ .js æ–‡ä»¶ä¸­è·³è½¬è·¯ç”±ã€‚ã€‚ã€‚è¿™äº›éƒ½éœ€è¦è‡ªå·±å®ç°ã€‚

åœ¨ Vueï¼ˆå°¤å…¶æ˜¯ Vue Routerï¼‰ä¸­ï¼Œå¾ˆå¤šåŠŸèƒ½æ˜¯**å¼€ç®±å³ç”¨**çš„ï¼Œæ¯”å¦‚ï¼š

- è·¯ç”±å®ˆå«ï¼ˆ`beforeEach`, `beforeEnter`ï¼‰
- é¡µé¢è·³è½¬æ—¶è‡ªåŠ¨æ»šåŠ¨åˆ°é¡¶éƒ¨
- åœ¨ä»»æ„ `.js` æ–‡ä»¶ä¸­é€šè¿‡ `router.push()` è·³è½¬

è€Œåœ¨ React ç”Ÿæ€ä¸­ï¼ˆä»¥ **React Router v6** ä¸ºä¸»æµï¼‰ï¼Œè¿™äº›åŠŸèƒ½**é»˜è®¤ä¸æä¾›**ï¼Œéœ€è¦å¼€å‘è€…è‡ªå·±å®ç°æˆ–å€ŸåŠ©å·¥å…·ã€‚ä½†è¿™å¹¶ä¸æ˜¯â€œç¼ºé™·â€ï¼Œè€Œæ˜¯ React ç”Ÿæ€â€œ**ç»„åˆä¼˜äºå†…ç½®**â€å“²å­¦çš„ä½“ç°ã€‚

ä¸‹é¢é€ä¸€è¯´æ˜å¦‚ä½•åœ¨ React ä¸­å®ç°è¿™äº›å¸¸è§éœ€æ±‚ã€‚

---

### 1ï¸âƒ£ è·¯ç”±å®ˆå«ï¼ˆRoute Guardï¼‰

#### âŒ React Router v6 æ²¡æœ‰å…¨å±€ `beforeEach`

Vue Router çš„ `router.beforeEach` å¯ä»¥æ‹¦æˆªæ‰€æœ‰è·³è½¬ï¼Œåšç™»å½•éªŒè¯ç­‰ã€‚

#### âœ… React è§£å†³æ–¹æ¡ˆï¼šè‡ªå®šä¹‰ `<ProtectedRoute>` ç»„ä»¶

```jsx
// components/ProtectedRoute.js
import { Navigate } from 'react-router-dom'
import { useAuth } from '../hooks/useAuth' // å‡è®¾ä½ æœ‰ç™»å½•çŠ¶æ€

export default function ProtectedRoute({ children }) {
  const { isAuthenticated } = useAuth()

  if (!isAuthenticated) {
    // æœªç™»å½•ï¼Œè·³è½¬åˆ°ç™»å½•é¡µ
    return <Navigate to="/login" replace />
  }

  return children
}
```

**ä½¿ç”¨æ–¹å¼ï¼š**

```jsx
<Route
  path="/profile"
  element={
    <ProtectedRoute>
      <ProfilePage />
    </ProtectedRoute>
  }
/>
```

> âœ… è¿™æ¯”å…¨å±€å®ˆå«æ›´çµæ´»ï¼šä½ å¯ä»¥ä¸ºä¸åŒè·¯ç”±è®¾ç½®ä¸åŒæƒé™é€»è¾‘ã€‚

---

### 2ï¸âƒ£ é¡µé¢è·³è½¬æ—¶æ»šåŠ¨æ¡ç½®é¡¶

#### âŒ React Router ä¸ä¼šè‡ªåŠ¨æ»šåŠ¨åˆ°é¡¶éƒ¨

Vue Router é»˜è®¤å¼€å¯ `scrollBehavior`ï¼Œä½† React Router æ²¡æœ‰ã€‚

#### âœ… è§£å†³æ–¹æ¡ˆï¼šç›‘å¬è·¯ç”±å˜åŒ– + `window.scrollTo`

```jsx
// hooks/useScrollToTop.js
import { useEffect } from 'react'
import { useLocation } from 'react-router-dom'

export default function useScrollToTop() {
  const { pathname } = useLocation()

  useEffect(() => {
    // æ¯æ¬¡è·¯ç”±å˜åŒ–ï¼Œæ»šåŠ¨åˆ°é¡¶éƒ¨
    window.scrollTo(0, 0)
  }, [pathname])
}
```

**åœ¨ App æ ¹ç»„ä»¶ä¸­ä½¿ç”¨ï¼š**

```jsx
// App.js
import { BrowserRouter } from 'react-router-dom'
import useScrollToTop from './hooks/useScrollToTop'

function App() {
  useScrollToTop() // å…¨å±€ç”Ÿæ•ˆ

  return <BrowserRouter>{/* ä½ çš„è·¯ç”± */}</BrowserRouter>
}
```

> âœ… æ”¯æŒ hash è·¯ç”±ã€åµŒå¥—è·¯ç”±ï¼Œç®€å•å¯é ã€‚

---

### 3ï¸âƒ£ åœ¨ `.js` æ–‡ä»¶ä¸­è·³è½¬è·¯ç”±ï¼ˆéç»„ä»¶å†…ï¼‰

#### âŒ React Router çš„ `useNavigate` åªèƒ½åœ¨å‡½æ•°ç»„ä»¶ä¸­ç”¨

ä½ ä¸èƒ½åœ¨å·¥å…·å‡½æ•°ã€API å°è£…ã€store é‡Œç›´æ¥è°ƒç”¨ `useNavigate()`ã€‚

#### âœ… è§£å†³æ–¹æ¡ˆï¼šåˆ›å»ºä¸€ä¸ªå¯å¯¼å‡ºçš„å¯¼èˆªå™¨ï¼ˆNavigation Singletonï¼‰

```jsx
// utils/navigation.js
let navigateFn = null

export function setNavigate(navigate) {
  navigateFn = navigate
}

export function navigateTo(path) {
  if (navigateFn) {
    navigateFn(path)
  } else {
    console.warn('navigateTo called before router initialized')
  }
}
```

**åœ¨ App ä¸­åˆå§‹åŒ–ï¼š**

```jsx
// App.js
import { useNavigate } from 'react-router-dom';
import { setNavigate } from './utils/navigation';

function App() {
  const navigate = useNavigate();

  // åˆå§‹åŒ–å…¨å±€å¯¼èˆª
  useEffect(() => {
    setNavigate(navigate);
  }, [navigate]);

  return (/* your app */);
}
```

**ç°åœ¨ä½ å¯ä»¥åœ¨ä»»ä½• `.js` æ–‡ä»¶ä¸­è·³è½¬ï¼š**

```js
// api/auth.js
import { navigateTo } from '../utils/navigation'

export async function login(data) {
  const res = await fetch('/api/login', { method: 'POST', body: data })
  if (res.ok) {
    navigateTo('/dashboard') // âœ… æˆåŠŸï¼
  }
}
```

> âš ï¸ æ³¨æ„ï¼šè¿™ç§æ–¹å¼æ‰“ç ´äº† React çš„æ•°æ®æµåŸåˆ™ï¼Œ**ä»…ç”¨äºå¿…è¦åœºæ™¯**ï¼ˆå¦‚ API é”™è¯¯ç»Ÿä¸€è·³è½¬ï¼‰ã€‚ä¼˜å…ˆè€ƒè™‘åœ¨ç»„ä»¶ä¸­å¤„ç†è·³è½¬ã€‚

---

### ğŸ¯ æ€»ç»“ï¼šReact æ˜¯â€œç»™ä½ ç§¯æœ¨ï¼Œè®©ä½ æ­æˆ¿å­â€

| åŠŸèƒ½       | Vue Router            | React Router                      |
| ---------- | --------------------- | --------------------------------- |
| è·¯ç”±å®ˆå«   | å†…ç½® `beforeEach`     | ç”¨ `<ProtectedRoute>` è‡ªå®šä¹‰      |
| æ»šåŠ¨ç½®é¡¶   | å†…ç½® `scrollBehavior` | ç”¨ `useEffect + useLocation` å®ç° |
| éç»„ä»¶è·³è½¬ | `this.$router.push()` | éœ€æ‰‹åŠ¨åˆ›å»ºå¯¼èˆªå™¨å•ä¾‹              |

âœ… **React çš„ä¼˜åŠ¿**ï¼š

- æ¯ä¸ªåŠŸèƒ½éƒ½é€æ˜ã€å¯æ›¿æ¢ã€å¯æµ‹è¯•
- ä¸ä¼šè¢«æ¡†æ¶â€œç»‘æ¶â€ï¼Œé€‚åˆå¤æ‚åœºæ™¯

âŒ **ä»£ä»·**ï¼š

- åˆå­¦è€…éœ€è¦å¤šå†™å‡ è¡Œä»£ç 
- éœ€è¦ç†è§£â€œç»„åˆâ€æ€æƒ³

---

### å»ºè®®

- å¯¹äºæ–°é¡¹ç›®ï¼Œå¯ä»¥å°è£…è‡ªå·±çš„ `router-utils.js`ï¼ŒæŠŠä¸Šè¿°åŠŸèƒ½é›†ä¸­ç®¡ç†ã€‚
- æˆ–è€…ä½¿ç”¨ç¤¾åŒºåº“ï¼ˆå¦‚ `react-router-scroll-top`ï¼‰åŠ é€Ÿå¼€å‘ã€‚
- ä½†**ä¸è¦å› ä¸ºâ€œå¤šå†™å‡ è¡Œâ€å°±è§‰å¾— React â€œä¸å¥½ç”¨â€** â€”â€” è¿™äº›ä»£ç ä½ åªéœ€è¦å†™ä¸€æ¬¡ï¼Œæ¢æ¥çš„æ˜¯é•¿æœŸçš„å¯æ§æ€§å’Œçµæ´»æ€§ã€‚

> æ­£å¦‚ React å®˜æ–¹æ‰€è¯´ï¼š**â€œLearn once, write anywhere.â€**  
> å®ƒæ•™ä½ çš„ä¸æ˜¯â€œæ€ä¹ˆç”¨æŸä¸ª APIâ€ï¼Œè€Œæ˜¯â€œæ€ä¹ˆè§£å†³é—®é¢˜â€ã€‚

## React å°±åƒæ‰‹åŠ¨æŒ¡ã€Vue å°±åƒè‡ªåŠ¨æŒ¡

> **React å°±åƒæ‰‹åŠ¨æŒ¡ï¼ˆManual Transmissionï¼‰**  
> **Vue å°±åƒè‡ªåŠ¨æŒ¡ï¼ˆAutomatic Transmissionï¼‰**

ä¸ºä»€ä¹ˆè¿™ä¸ªç±»æ¯”æ—¢ç”ŸåŠ¨åˆå‡†ç¡®ï¼š

---

### æ‰‹åŠ¨æŒ¡ï¼ˆReactï¼‰ï¼šæŒæ§ä¸€åˆ‡ï¼Œä½†éœ€è¦æŠ€å·§

- **ä½ æ§åˆ¶æ¯ä¸€ä¸ªç»†èŠ‚**ï¼šä»€ä¹ˆæ—¶å€™æ¢æŒ¡ï¼ˆçŠ¶æ€æ›´æ–°ï¼‰ã€æ€ä¹ˆè¸©ç¦»åˆï¼ˆç”Ÿå‘½å‘¨æœŸ/å‰¯ä½œç”¨ï¼‰ã€å¦‚ä½•é…åˆæ²¹é—¨ï¼ˆæ•°æ®æµï¼‰ã€‚
- **ä¼˜ç‚¹**ï¼š
  - æè‡´çš„æ§åˆ¶åŠ›ï¼šå¯ä»¥å‹æ¦¨æ€§èƒ½ã€ç²¾ç¡®ä¼˜åŒ–ã€‚
  - ç†è§£åº•å±‚åŸç†åï¼Œé©¾é©¶ï¼ˆå¼€å‘ï¼‰æ›´è‡ªä¿¡ã€‚
  - é€‚åˆå¤æ‚è·¯å†µï¼ˆå¤§å‹ã€é«˜å®šåˆ¶åŒ–é¡¹ç›®ï¼‰ã€‚
- **ç¼ºç‚¹**ï¼š
  - ä¸Šæ‰‹é—¨æ§›é«˜ï¼šæ–°æ‰‹å®¹æ˜“ç†„ç«ï¼ˆå†™é”™ `useEffect` ä¾èµ–ã€çŠ¶æ€ä¸åŒæ­¥ï¼‰ã€‚
  - æ“ä½œç¹çï¼šæ¯æ¬¡æ¢æŒ¡éƒ½è¦è¸©ç¦»åˆ + æŒ‚æŒ¡ï¼ˆå†™ `useState` + `onChange`ï¼‰ã€‚
  - å®¹æ˜“ç–²åŠ³ï¼šé•¿æ—¶é—´å¼€å‘éœ€è¦é«˜åº¦ä¸“æ³¨ã€‚

> ğŸ’¡ ä½†è€å¸æœºï¼ˆèµ„æ·± React å¼€å‘è€…ï¼‰ä¼šè§‰å¾—ï¼šâ€œåªæœ‰æ‰‹åŠ¨æŒ¡æ‰å«å¼€è½¦ï¼â€

---

### è‡ªåŠ¨æŒ¡ï¼ˆVueï¼‰ï¼šçœå¿ƒçœåŠ›ï¼Œå¼€ç®±å³ç”¨

- **ç³»ç»Ÿå¸®ä½ æå®šå¤§éƒ¨åˆ†æ“ä½œ**ï¼šä½ åªç®¡è¸©æ²¹é—¨ï¼ˆå†™ä¸šåŠ¡é€»è¾‘ï¼‰ï¼Œæ¢æŒ¡ï¼ˆå“åº”å¼æ›´æ–°ã€è·¯ç”±å®ˆå«ã€åŒå‘ç»‘å®šï¼‰å…¨è‡ªåŠ¨ã€‚
- **ä¼˜ç‚¹**ï¼š
  - ä¸Šæ‰‹å¿«ï¼šä¼šå¼€è½¦å°±èƒ½ä¸Šè·¯ï¼ˆå‡ åˆ†é’Ÿå†™å‡ºå¯è¿è¡Œé¡µé¢ï¼‰ã€‚
  - å¼€å‘æµç•…ï¼š`v-model`ã€`<keep-alive>`ã€`router.beforeEach` å…¨éƒ½å†…ç½®ã€‚
  - é€‚åˆæ—¥å¸¸é€šå‹¤ï¼ˆä¸­å°å‹é¡¹ç›®ã€å¿«é€Ÿäº¤ä»˜ï¼‰ã€‚
- **ç¼ºç‚¹**ï¼š
  - é»‘ç›’æ„Ÿå¼ºï¼šæœ‰æ—¶å€™ä¸çŸ¥é“â€œè½¦ä¸ºä»€ä¹ˆçªç„¶é™æ¡£â€ï¼ˆå“åº”å¼å¤±æ•ˆã€`nextTick` æ—¶æœºé—®é¢˜ï¼‰ã€‚
  - å®šåˆ¶æ€§å¼±ï¼šæƒ³æ·±åº¦ä¼˜åŒ–ï¼Ÿå¾—å…ˆææ‡‚ Vue å†…éƒ¨æ€ä¹ˆâ€œè‡ªåŠ¨æ¢æŒ¡â€çš„ã€‚
  - æé™åœºæ™¯å—é™ï¼šæ¯”å¦‚å¾®å‰ç«¯ã€è¶…é«˜æ€§èƒ½åŠ¨ç”»ï¼Œå¯èƒ½ä¸å¦‚æ‰‹åŠ¨ç²¾ç»†æ§åˆ¶ã€‚

> å¯¹å¤§å¤šæ•°ç”¨æˆ·æ¥è¯´ï¼šâ€œè‡ªåŠ¨æŒ¡å¤Ÿç”¨äº†ï¼Œä½•å¿…æŠ˜è…¾ç¦»åˆï¼Ÿâ€

---

### å®é™…å¼€å‘ä¸­çš„ä½“ç°

| åœºæ™¯         | æ‰‹åŠ¨æŒ¡ï¼ˆReactï¼‰                   | è‡ªåŠ¨æŒ¡ï¼ˆVueï¼‰              |
| ------------ | --------------------------------- | -------------------------- |
| è¡¨å•è¾“å…¥     | å†™ `value + onChange`             | ä¸€è¡Œ `v-model`             |
| è·¯ç”±è·³è½¬å®ˆå« | è‡ªå·±å°è£… `<ProtectedRoute>`       | ç›´æ¥ç”¨ `router.beforeEach` |
| é¡µé¢æ»šåŠ¨ç½®é¡¶ | ç›‘å¬ `useLocation` + `scrollTo`   | é…ç½® `scrollBehavior`      |
| éç»„ä»¶è·³è½¬   | åˆ›å»ºå¯¼èˆªå•ä¾‹                      | `this.$router.push()`      |
| çŠ¶æ€ç®¡ç†     | å¯é€‰ï¼ˆContext / Zustand / Reduxï¼‰ | å†…ç½® `reactive` / `ref`    |

---

### æ²¡æœ‰å¥½åï¼Œåªæœ‰é€‚åˆ

- **é€‰æ‰‹åŠ¨æŒ¡ï¼ˆReactï¼‰å¦‚æœä½ **ï¼š

  - å–œæ¬¢æŒæ§ä¸€åˆ‡
  - é¡¹ç›®å¤æ‚ã€éœ€è¦æè‡´ä¼˜åŒ–
  - å›¢é˜Ÿæœ‰è¾ƒå¼ºå·¥ç¨‹èƒ½åŠ›
  - æƒ³æ·±å…¥ç†è§£å‰ç«¯åº•å±‚

- **é€‰è‡ªåŠ¨æŒ¡ï¼ˆVueï¼‰å¦‚æœä½ **ï¼š
  - è¿½æ±‚å¼€å‘æ•ˆç‡
  - å›¢é˜Ÿä»¥ä¸šåŠ¡äº¤ä»˜ä¸ºä¸»
  - å¸Œæœ›å‡å°‘æ ·æ¿ä»£ç 
  - å¿«é€Ÿä¸Šæ‰‹ã€å¿«é€Ÿä¸Šçº¿

---

### æœ€åä¸€å¥è¯æ€»ç»“ï¼š

> **Vue è®©ä½ æ›´å¿«åˆ°è¾¾ç›®çš„åœ°ï¼ŒReact è®©ä½ æ›´æ¸…æ¥šè‡ªå·±æ˜¯æ€ä¹ˆåˆ°çš„ã€‚**

ä¸¤è€…éƒ½æ˜¯ä¼˜ç§€çš„æ¡†æ¶ï¼Œå°±åƒæ‰‹åŠ¨æŒ¡å’Œè‡ªåŠ¨æŒ¡â€”â€”  
**ä¸æ˜¯è°æ›´å¥½ï¼Œè€Œæ˜¯çœ‹ä½ è¦å¼€ä»€ä¹ˆè·¯ã€å»ä»€ä¹ˆåœ°æ–¹ã€å’Œè°ä¸€èµ·å¼€ã€‚**

## ç›®å‰é¡¹ç›®ç»„å­˜åœ¨çš„é—®é¢˜

- React çŸ­æ¿ï¼Œä¸ç†Ÿæ‚‰åªæœ‰ä¸€ä¸ªåŸå› ï¼Œå†™çš„å°‘
- åŒºå—é“¾ç›¸å…³çŸ¥è¯†ç¼ºä¹

---

### 1. â€œå†™çš„å°‘â€

è¿™æ˜¯**æœ€çœŸå®ä¹Ÿæœ€å®¹æ˜“è§£å†³**çš„é—®é¢˜ã€‚

#### â€œå†™å¾—å°‘â€ä¼šå¯¼è‡´ä¸ç†Ÿ

- React çš„æ ¸å¿ƒä¸æ˜¯è¯­æ³•ï¼Œè€Œæ˜¯**æ€ç»´æ¨¡å¼**ï¼šçŠ¶æ€é©±åŠ¨ã€å•å‘æ•°æ®æµã€å‰¯ä½œç”¨ç®¡ç†ã€ç»„ä»¶ç»„åˆã€‚
- è¿™äº›æ¦‚å¿µå…‰çœ‹æ–‡æ¡£æˆ–è§†é¢‘æ˜¯â€œæ‡‚äº†â€ï¼Œä½†åªæœ‰**äº²æ‰‹å†™ã€æ”¹ã€è°ƒã€é‡æ„**ï¼Œæ‰èƒ½å†…åŒ–æˆç›´è§‰ã€‚
- æ¯”å¦‚ï¼š
  - ä»€ä¹ˆæ—¶å€™ç”¨ `useCallback`ï¼Ÿ
  - ä¸ºä»€ä¹ˆ `useEffect` ä¾èµ–æ•°ç»„æ¼äº†ä¼šå‡º bugï¼Ÿ
  - è¡¨å•åˆ°åº•è¯¥ç”¨å—æ§è¿˜æ˜¯éå—æ§ï¼Ÿ
    â†’ è¿™äº›é—®é¢˜åªæœ‰åœ¨**çœŸå®é¡¹ç›®ä¸­è¸©å‘**æ‰èƒ½çœŸæ­£æŒæ¡ã€‚

#### å¦‚ä½•å¿«é€Ÿæå‡ï¼Ÿ

- ä» 0 åˆ° 1 åšé¡¹ç›®

| æ–¹æ³•             | å…·ä½“è¡ŒåŠ¨                                                                         |
| ---------------- | -------------------------------------------------------------------------------- |
| **æ¯å¤©å†™ä¸€ç‚¹**   | å“ªæ€•åªå†™ä¸€ä¸ªå°ç»„ä»¶ï¼ˆå¦‚å¸¦æœç´¢çš„åˆ—è¡¨ã€æ¨¡æ€æ¡†å°è£…ï¼‰                                 |
| **é‡å†™æ—§é¡¹ç›®**   | æŠŠä½ ç”¨ Vue å†™è¿‡çš„é¡µé¢ï¼Œç”¨ React é‡å†™ä¸€éï¼ˆå¯¹æ¯”ä½“éªŒå·®å¼‚ï¼‰                         |
| **æ¨¡ä»¿ä¼˜ç§€ä»£ç ** | åœ¨ GitHub æ‰¾å¼€æº React é¡¹ç›®ï¼ˆå¦‚ Ant Design Proï¼‰ï¼Œçœ‹åˆ«äººæ€ä¹ˆç»„ç»‡è¡¨å•ã€è·¯ç”±ã€çŠ¶æ€ |
| **åˆ»æ„ç»ƒä¹ çŸ­æ¿** | å¦‚æœä¸ç†Ÿ `useReducer`ï¼Œå°±ä¸“é—¨å†™ä¸€ä¸ªè´­ç‰©è½¦ï¼›ä¸ç†Ÿ Contextï¼Œå°±å®ç°ä¸€ä¸ªä¸»é¢˜åˆ‡æ¢      |

> **è®°ä½ï¼šReact ä¸æ˜¯â€œå­¦ä¸ä¼šâ€ï¼Œè€Œæ˜¯â€œç»ƒä¸å¤Ÿâ€ã€‚**

---

### 2. â€œåŒºå—é“¾ç›¸å…³çŸ¥è¯†ç¼ºä¹â€

è¿™æ˜¯**é¢†åŸŸçŸ¥è¯†ï¼ˆDomain Knowledgeï¼‰** çš„é—®é¢˜ï¼Œå’Œå‰ç«¯æ¡†æ¶æ— å…³ï¼Œä½†å¯¹ Web3 å¼€å‘è‡³å…³é‡è¦ã€‚

#### åŒºå—é“¾å¼€å‘éœ€è¦å“ªäº›åŸºç¡€çŸ¥è¯†ï¼Ÿ

| å±‚çº§         | å…³é”®æ¦‚å¿µ                                                        |
| ------------ | --------------------------------------------------------------- |
| **åŸºç¡€å±‚**   | åŒºå—é“¾æ˜¯ä»€ä¹ˆã€é’±åŒ…ï¼ˆç§é’¥/å…¬é’¥/åœ°å€ï¼‰ã€Gas è´¹ã€äº¤æ˜“ã€åŒºå—        |
| **äº¤äº’å±‚**   | EVMï¼ˆä»¥å¤ªåŠè™šæ‹Ÿæœºï¼‰ã€æ™ºèƒ½åˆçº¦ã€ABIã€RPC è°ƒç”¨ï¼ˆå¦‚ `eth_call`ï¼‰   |
| **å‰ç«¯é›†æˆ** | é’±åŒ…è¿æ¥ï¼ˆMetaMaskï¼‰ã€`ethers.js` / `web3.js`ã€ç­¾åã€è·¨é“¾æ¡¥åŸç† |
| **ä¸šåŠ¡å±‚**   | Swapã€Stakingã€NFT mintã€è·¨é“¾èµ„äº§æ˜ å°„ç­‰åœºæ™¯é€»è¾‘                 |

#### å¦‚ä½•é«˜æ•ˆè¡¥è¶³ï¼Ÿ

| æ–¹å¼           | æ¨èèµ„æº                                                         |
| -------------- | ---------------------------------------------------------------- |
| **åŠ¨æ‰‹è¿é’±åŒ…** | ç”¨ `ethers.js` å†™ä¸€ä¸ªâ€œè·å–ç”¨æˆ·åœ°å€ + ä½™é¢â€çš„å° demo              |
| **è¯»å®˜æ–¹æ–‡æ¡£** | [Ethers.js Docs](https://docs.ethers.org/)ï¼ˆæ¯” web3.js æ›´ç°ä»£ï¼‰  |
| **çœ‹çœŸå®ä»£ç ** | åˆ†æ Uniswapã€Aave çš„å‰ç«¯æºç ï¼ˆGitHub å¼€æºï¼‰                     |
| **ç†è§£ä¸šåŠ¡æµ** | ç”»ä¸€å¼ â€œç”¨æˆ·ä»è¿æ¥é’±åŒ…åˆ°å®Œæˆè·¨é“¾â€çš„æµç¨‹å›¾ï¼Œæ ‡æ³¨æ¯ä¸€æ­¥å‰ç«¯è¦åšä»€ä¹ˆ |

> **ä¸è¦è¯•å›¾â€œå…ˆå­¦å®Œæ‰€æœ‰åŒºå—é“¾çŸ¥è¯†å†å¼€å‘â€** â€”â€” è¾¹åšè¾¹å­¦æ‰æ˜¯æœ€å¿«è·¯å¾„ã€‚  
> æ¯”å¦‚ä½ ç°åœ¨åšâ€œè·¨é“¾æ¡¥â€ï¼Œå°±èšç„¦ï¼š
>
> - ç”¨æˆ·é€‰é“¾ â†’ å‰ç«¯å¦‚ä½•è·å–é“¾ IDï¼Ÿ
> - æäº¤äº¤æ˜“ â†’ å¦‚ä½•æ„é€ åˆçº¦è°ƒç”¨ï¼Ÿ
> - çŠ¶æ€è½®è¯¢ â†’ å¦‚ä½•ç›‘å¬äº¤æ˜“ä¸Šé“¾ï¼Ÿ

---

### æœ€åä¸€å¥è¯ï¼š

> **â€œä¸ç†Ÿâ€ä¸æ˜¯èƒ½åŠ›é—®é¢˜ï¼Œæ˜¯æš´éœ²é‡é—®é¢˜ï¼›  
> â€œä¸æ‡‚â€ä¸æ˜¯æ™ºå•†é—®é¢˜ï¼Œæ˜¯è¿˜æ²¡èµ°åˆ°é‚£ä¸ªè·¯å£ã€‚â€**

æ„è¯†åˆ°çŸ­æ¿ï¼Œè¯´æ˜ä½ æ­£åœ¨èµ°ä¸Šå‡é€šé“ã€‚  
**ç»§ç»­å†™ï¼Œç»§ç»­é—®ï¼Œç»§ç»­åšâ€”â€”ä¸‰ä¸ªæœˆåå›å¤´çœ‹ï¼Œå°±ä¼šæƒŠè®¶è‡ªå·±çš„è¿›æ­¥ã€‚**
